[{"path":"index.html","id":"course-syllabus","chapter":"Course syllabus","heading":"Course syllabus","text":"main goal course give tools ease (high-performing effcient) code development . performance side come second part, initial tools introduced also useful situations require\nimportant computation times.focus presentation development tools focuusing notion package. already familiar notion, already\nalready installed packages CRAN example ! also know standard way  distribuute code make available.\nshow package also excellent tool developing code.follow outline :Build packageBuild packageTracking changes, sharing code, collaborative development automating tests packageTracking changes, sharing code, collaborative development automating tests packageMeasure computation timeMeasure computation timeProfile codeProfile codeUse Rcpp optimize needs optimizedUse Rcpp optimize needs optimizedParallelize code easilyParallelize code easilyTo take course, need following softwares installed:latest version  (https://cloud.r-project.org/)latest version  (https://cloud.r-project.org/)latest version RStudio (https://www.rstudio.com/products/rstudio/download/#download)latest version RStudio (https://www.rstudio.com/products/rstudio/download/#download)C++ compiler (gcc clang - native UNIX systems,\nWindows users recommend installing\nRtools, \nMac users may necessary install macOS tool chain (namely Xcode Command Line Tools gfortran) used  detailed )C++ compiler (gcc clang - native UNIX systems,\nWindows users recommend installing\nRtools, \nMac users may necessary install macOS tool chain (namely Xcode Command Line Tools gfortran) used  detailed )following  packages: devtools, future.apply, itertools, microbenchmark, mvtnorm, profvis, Rcpp, RcppArmadillo, roxygen2, testthat, usethisthe following  packages: devtools, future.apply, itertools, microbenchmark, mvtnorm, profvis, Rcpp, RcppArmadillo, roxygen2, testthat, usethisthe software gitthe software git","code":""},{"path":"building-a-package.html","id":"building-a-package","chapter":"1 Building a  package","heading":"1 Building a  package","text":"present efficiently create build package using Rstudio IDE, devtools usethis packages.details provided reference material subject: book R packages Hadley Wickham, freely available online.","code":""},{"path":"building-a-package.html","id":"initializing-a-package","chapter":"1 Building a  package","heading":"1.1 Initializing a package","text":"simple way, built Rstudio, initialize package :create new project (top left File drop menu Rstudio)create new project (top left File drop menu Rstudio)choose â€œNew Directoryâ€choose â€œNew Directoryâ€choose â€œR package using devtoolsâ€ (available, choose â€œR\npackageâ€, difference â€œR packageâ€ delete unnecessary files automatically created useful)choose â€œR package using devtoolsâ€ (available, choose â€œR\npackageâ€, difference â€œR packageâ€ delete unnecessary files automatically created useful)give name package, example mypkgr.give name package, example mypkgr., get minimal structure  package, namely:DESCRIPTION file whose Title, Version, Authors@R \nDescription edited (parts can edited even added automatically, see\neven added automatically, see )DESCRIPTION file whose Title, Version, Authors@R \nDescription edited (parts can edited even added automatically, see\neven added automatically, see )NAMESPACE file later edited automatically\n(hands now)NAMESPACE file later edited automatically\n(hands now)folder R add .R script filesa folder R add .R script filesdevtools also adds three optional files:.gitignore, relative git, version control tool see detail\nsection GitHub.gitignore, relative git, version control tool see detail\nsection GitHubmypkgr.Rproj specific file Rstudio, allows define\ncharacteristics preferences project just createdmypkgr.Rproj specific file Rstudio, allows define\ncharacteristics preferences project just created.Rbuildignore allows ignore files build package road (example, mypkgr.Rproj file included package).Rbuildignore allows ignore files build package road (example, mypkgr.Rproj file included package)","code":""},{"path":"building-a-package.html","id":"adding-a-function-common-theme-example","chapter":"1 Building a  package","heading":"1.2 Adding a function: common theme example","text":"first invite code following function, use throughout course:want compute value density multivariate normal distribution\n\\(\\mathbb{R}^p\\) \\(n\\) points. function must applicable \nmultivariate normal distribution (.e.Â mean vector \n\\(\\mathbb{R}^p\\) variance-covariance matrix order \\(p\\)),\nwish compute values density evaluated\n\\(n\\) points single call function.need create function mvnpdf() file named mvnpdf.R\n folder package, :takes arguments:\nx matrix, \\(n\\) columns (observations) \\(p\\) rows\nmean vector means\nvarcovM variance-covariance matrix\nLog logical parameter, default value TRUE.\ntakes arguments:x matrix, \\(n\\) columns (observations) \\(p\\) rowsx matrix, \\(n\\) columns (observations) \\(p\\) rowsmean vector meansmean vector meansvarcovM variance-covariance matrixvarcovM variance-covariance matrixLog logical parameter, default value TRUE.Log logical parameter, default value TRUE.returns list containing matrix x, vector length \\(n\\)\nmultivariate normal distribution density values points.returns list containing matrix x, vector length \\(n\\)\nmultivariate normal distribution density values points.ğŸ‘‰ turn !âš ï¸ WARNING ! click quickly link , invalidate participation class !function proposal can download\n.advice writing code, see \nR code section Hadley Wickam R packages online book.","code":""},{"path":"building-a-package.html","id":"documenting-a-function","chapter":"1 Building a  package","heading":"1.3 Documenting a function","text":"important properly document code. Every project least 2\ndevelopers:,,6 months.6 months.sake future self, favor take time document\ncode !strongly advise use roxygen2 package document\npackages. main advantage help function \nfile code defining function.ğŸ‘‰ turn!Start inserting skeleton helper â€œInsert Roxygen\nSkeletonâ€ located â€œCodeâ€ menu Magic Wand sub-menu \nscript window.Start inserting skeleton helper â€œInsert Roxygen\nSkeletonâ€ located â€œCodeâ€ menu Magic Wand sub-menu \nscript window.Complete documentation filling :Complete documentation filling :title function (first line)title function (first line)description function (second paragraph)description function (second paragraph)fill third paragraph, part go â€œDetailsâ€ section \nhelp pageif fill third paragraph, part go â€œDetailsâ€ section \nhelp pagethe meaning parametersthe meaning parametersthe output, @return tagthe output, @return tagGenerate documentation using â€œDocumentâ€ â€œâ€ menu \nBuildâ€ tab (Ctrl+Shift+D devtools::document()). effect \ncommand multiple:man folder created inside , mvnpdf.Rd file contains help information functiona man folder created inside , mvnpdf.Rd file contains help information functionthe NAMESPACE file modifiedthe NAMESPACE file modifiedIn case problems curiosity done, can look \nproposal.details package documentation \nroxygen2 tags, see \nObject documentation secttion Hadley Wickam R packages online book.Letâ€™s finish mentioning function usethis package initializes \nhome help page whole package:generated help page accessible, package installed,\nfollowing command:","code":"\nusethis::use_package_doc()\n?mypkgr"},{"path":"building-a-package.html","id":"interactively-test-the-package","chapter":"1 Building a  package","heading":"1.4 Interactively test the package","text":"test package, load R using â€œLoad â€ (Ctrl+Shift+L) \nâ€œâ€ menu â€œBuildâ€ tab, alternatively devtools::load_all()).can use package directly R: see\nhelp function ?mvnpdf example execute commands given example section help page.code development, can thus:Add/Modify  codeAdd/Modify  codeRe-load package Ctrl+Shift+LRe-load package Ctrl+Shift+LExperiment consoleExperiment consoleAnd â€¦â€¦","code":"\n?mvndpf"},{"path":"building-a-package.html","id":"automatically-test-your-package","chapter":"1 Building a  package","heading":"1.5 Automatically test your package","text":"initialize automatic testing capabilities package, execute following command:command creates tests folder includes testthat.R file â€“ modified â€“ testthat folder add automated tests. tool based theory unit tests.example, content file call test-univariate.R put testthat folder:second one named test-bivariate.R :execute tests, can click â€œTest packageâ€ (Ctrl+Shift+T) â€œâ€ menu â€œBuildâ€ tab, run devtools::test()advantage automatic tests run every time check package.good practice add unit test time bug identified fixed,\ncan immediately identify prevent error happening \nfuture.","code":"\nusethis::use_testthat()\ncontext(\"Univariate gaussian test\")\n\ntest_that(\"correct result for univariate gaussian\", {\n  expect_equal(mvnpdf(x=matrix(1.96), Log=FALSE)$y, dnorm(1.96))\n  expect_equal(mvnpdf(x=matrix(c(1.96, -0.5), ncol = 2), Log=FALSE)$y,\n               dnorm(c(1.96, -0.5)))\n})\ncontext(\"Bivariate gaussian test\")\n\ntest_that(\"correct results for bivariate gaussian\", {\n  expect_equal(mvnpdf(x=matrix(rep(1.96,2), nrow=2, ncol=1), Log=FALSE)$y,\n               mvtnorm::dmvnorm(rep(1.96, 2)))\n})"},{"path":"building-a-package.html","id":"checking-your-package","chapter":"1 Building a  package","heading":"1.6 Checking your package","text":"Ruunning check means ensuring tthat everything package correct work expected, can installed properly.\nâ€œPassing R CMD CHECKâ€ mandatory successfully uploading package CRAN.perform R CMD CHECK package, can click â€œCheckâ€ (Ctrl+Shift+E) â€œBuildâ€ tab, run devtools::check().check, automated unitt tests developed previously \nexecuted. advantage written tests, donâ€™t need worry , simply react adjust code errors returned flagged.","code":""},{"path":"building-a-package.html","id":"install-your-package","chapter":"1 Building a  package","heading":"1.7 Install your package","text":"moment, package exists environment associated Rstudio project created. able use anywhere (computer)  general way, install (like CRAN package example)., click â€œInstall Restartâ€ (Ctrl+Shift+B) â€œBuildâ€ tab, alternatively can run devtools::install().finally, can configure Rstudioâ€™s behavior time installation, simultaneously documents package: go â€œâ€ menu â€œBuildâ€ tab, â€œConfigure Build Toolsâ€. click â€œConfigureâ€ check box bottom â€œInstall Restartâ€.","code":""},{"path":"building-a-package.html","id":"appendix-1.1-add-an-s3-method","chapter":"1 Building a  package","heading":"1.8 Appendix 1.1: add an S3 method","text":"packages, oftten implement called S3 methods , result object res, one can run print(res), summary(res), plot(res)â€¦example plot() method can add package:âš ï¸ WARNING !order S3 method want apply \nresult function mvnpdf(), declare mvnpdf() returns result class mvnpdf.Test function, executing example.Donâ€™t forget re-install package (â€œInstall Restartâ€ Ctrl+Shift+B).Look contents man folder changes made NAMESPACE.proposed solution: file\ncontains complete code mvnpdf() function associated plot() method.","code":"\n#' Plot of the mvnpdf function\n#'\n#' @param x an object of class \\code{mvnpdf} resulting from a call of\n#' \\code{mnvpdf()} function.\n#' @param ... graphical parameters passed to \\code{plot()} function.\n#'\n#' @return Nothing is returned, only a plot is given.\n#' @export\n#'\n#' @examples\n#' pdfvalues <- mvnpdf(x=matrix(seq(-3, 3, by = 0.1), nrow = 1), Log=FALSE)\n#' plot(pdfvalues)\nplot.mvnpdf <- function(x, ...) {\n  plot(x$x, x$y, type = \"l\", ...)\n}"},{"path":"building-a-package.html","id":"appendix-1.2-submit-ones-package-on-cran","chapter":"1 Building a  package","heading":"1.9 Appendix 1.2: submit oneâ€™s package on CRAN","text":"Run two following commands: devtools::check() followed devtools::submit_cran().\ndetails, see Hadley Wickhamâ€™s recommanded pipeline book R packages","code":""},{"path":"version-control-with-git-and-github.html","id":"version-control-with-git-and-github","chapter":"2 Version control with git and GitHub","heading":"2 Version control with git and GitHub","text":"interested solutions offered RStudio GitHub hosting version control projects. allows monitor changes history, help collaborative development facilitate continuous integration.","code":""},{"path":"version-control-with-git-and-github.html","id":"principles-of-version-control","chapter":"2 Version control with git and GitHub","heading":"2.1 Principles of version control","text":"principle version control record successive changes made files (especially .R files case).RStudio offers 2 integrated solutions version control:gitgitsvnsvn","code":""},{"path":"version-control-with-git-and-github.html","id":"git","chapter":"2 Version control with git and GitHub","heading":"2.1.1 git","text":"git version control software (.e.Â tool record history successive changes code allow share changes people). git command line program, necessarily intuitive use.git works follows: server cloud, updated version code available. time possible access version code online. contributor can download last updated version (action called pull),\nediting locally. changes made locally, \ncontributor can update online version code, changes become available everyone (action called push).NB: git designed lightweight files (text files) far optimized heavy /compressed files (e.g.Â .RData files).","code":""},{"path":"version-control-with-git-and-github.html","id":"subversion","chapter":"2 Version control with git and GitHub","heading":"2.1.2 subversion","text":"subversion solution available RStudio. works similar way git, less functionalities wonâ€™t detail (major difference \ncontributors work simultaneously version code).","code":""},{"path":"version-control-with-git-and-github.html","id":"use-git-locally-within-rstudio","chapter":"2 Version control with git and GitHub","heading":"2.2 Use git locally within RStudio","text":"ğŸ‘‰ turn !Start enabling git â€œGit/SVNâ€ tab â€œProject Optionsâ€ located â€œToolsâ€ menu follow instructions. can also use usethis::use_git().Start enabling git â€œGit/SVNâ€ tab â€œProject Optionsâ€ located â€œToolsâ€ menu follow instructions. can also use usethis::use_git().â€œGitâ€ tab now appears next â€œBuildâ€ tab,\nregister current state package making first commit:â€œGitâ€ tab now appears next â€œBuildâ€ tab,\nregister current state package making first commit:2a. Select files track (select .Rproj file)2a. Select files track (select .Rproj file)2b. write informative message (collaborators â€“ includes future self)2b. write informative message (collaborators â€“ includes future self)2c. click â€œCommitâ€ >2c. click â€œCommitâ€ >Add â€œ*.Rprojâ€ line â€œ.gitignoreâ€ file make new commitAdd â€œ*.Rprojâ€ line â€œ.gitignoreâ€ file make new commitVisualize changes history using visualization tools\nâ€œDiffâ€ â€œHistoryâ€ tools accessible â€œGitâ€ tabVisualize changes history using visualization tools\nâ€œDiffâ€ â€œHistoryâ€ tools accessible â€œGitâ€ tab","code":""},{"path":"version-control-with-git-and-github.html","id":"good-commit-practices","chapter":"2 Version control with git and GitHub","heading":"2.2.1 Good commit practices","text":"Ideally, commit solve one problem. fix entirety (complete), contain changes related problem (minimal). especially useful write informative commit messages (kind help collaborators, includes future self). also concise, describe reasons changes rather changes (visible Diff). NB: sometimes difficult follow guidelines letter, merely ideal guide. certainly prevent regularly making commits.hand, temptation â€œcleanâ€ tidy change-history natural, source unnecessary problems. contradicts traceability goal version control. Since code development generally complex, messy, non-linear intellectual process, normal recording changes reflects path. practice, future self first user change history, priority make easier future solving bugs extending functionality.","code":""},{"path":"version-control-with-git-and-github.html","id":"github","chapter":"2 Version control with git and GitHub","heading":"2.3 GitHub","text":"GitHub website offering online code hosting solution, based git. many alternative websites services (gitlab, bitbucket, â€¦) allowing host code also based git. GitHub popular  community, relatively easy use, even novice user.Advantages using GitHub:simple user-friendly graphical interface track history changes codea simple user-friendly graphical interface track history changes codethe latest development version code available online can reference (can even reference specific commit number freeze specific version code)latest development version code available online can reference (can even reference specific commit number freeze specific version code)users clear transparent channel report bugs/difficultiesusers clear transparent channel report bugs/difficultiesit greatly facilitates collaborative developmentit greatly facilitates collaborative development","code":""},{"path":"version-control-with-git-and-github.html","id":"upload-ones-package-onto-github","chapter":"2 Version control with git and GitHub","heading":"2.3.1 Upload oneâ€™s package  onto GitHub","text":"ğŸ‘‰ turn !Go https://github.com/ create GitHub account (hesitate, common convention use firstnamelastname username)Go https://github.com/ create GitHub account (hesitate, common convention use firstnamelastname username)Use usethis::use_github() follow instructions.Use usethis::use_github() follow instructions.Add â€œREADME.Rmdâ€ file package order nice home page GitHub\npage GitHub:Add â€œREADME.Rmdâ€ file package order nice home page GitHub\npage GitHub:3a. RStudio, run command usethis::use_readme_rmd()3a. RStudio, run command usethis::use_readme_rmd()3b. using â€œDiffâ€ tool â€œGitâ€ tab RStudio, review changes made previous command3b. using â€œDiffâ€ tool â€œGitâ€ tab RStudio, review changes made previous command3c. edit created â€œREADME.Rmdâ€ file, create corresponding README.md file running knitr (click wool ball â€œKnitâ€ top left RStudio), making 3rd commit containing changes3c. edit created â€œREADME.Rmdâ€ file, create corresponding README.md file running knitr (click wool ball â€œKnitâ€ top left RStudio), making 3rd commit containing changes3d. point, visit directory page GitHub, 3rd commit appear moment. synchronize online GitHub directory local folder. , click â€œPushâ€ â€œGitâ€ tab. Now, changes 3rd commit visible online GitHub.3d. point, visit directory page GitHub, 3rd commit appear moment. synchronize online GitHub directory local folder. , click â€œPushâ€ â€œGitâ€ tab. Now, changes 3rd commit visible online GitHub.","code":""},{"path":"version-control-with-git-and-github.html","id":"collaborative-code-production","chapter":"2 Version control with git and GitHub","heading":"2.4 Collaborative code production","text":"git GitHub particularly useful efficient several people collaborate develop code together. Indeed, everyone can pull push successive changes code, simultaneously, endusing always working latest version code. see different concepts useful case collaborative work.ğŸ‘‰ turn !pairing-another participant, add new buddy â€œcollaboratorâ€ GitHub directory â€œSettingsâ€ tab GitHub.pairing-another participant, add new buddy â€œcollaboratorâ€ GitHub directory â€œSettingsâ€ tab GitHub.moments later, added collaborator receives email inviting accept addition (check spam folder). Click link accept.moments later, added collaborator receives email inviting accept addition (check spam folder). Click link accept.RStudio, create new project form git using url buddyâ€™s project.RStudio, create new project form git using url buddyâ€™s project.","code":""},{"path":"version-control-with-git-and-github.html","id":"branches","chapter":"2 Version control with git and GitHub","heading":"2.4.1 Branches","text":"One useful features git branches. allows make important changes changes code without disrupting current operation. particularly useful explore development path donâ€™t know successful end.way, already using branches since beginning part. Indeed, default branch called â€œmasterâ€ (sometimes â€œmainâ€).Thanks system branches, obtain tree different commits time (nodes correspond separation branches).","code":""},{"path":"version-control-with-git-and-github.html","id":"merge","chapter":"2 Version control with git and GitHub","heading":"2.4.2 Merge","text":"-called â€œpullâ€ can decomposed 2 actions made git:first fetch, corresponds downloading online codefirst fetch, corresponds downloading online codeimmediately followed merge, merges local version downloaded changes.immediately followed merge, merges local version downloaded changes.conducting experimental development one branch one may want merge changes â€œmasterâ€ branch example, experiment proved successful.changes concern separate parts code, merging can done without problem. hand, two versions merged contain changes concern lines code since last common commit , encounter one () conflicts, manually resolved.","code":""},{"path":"version-control-with-git-and-github.html","id":"conflicts","chapter":"2 Version control with git and GitHub","heading":"2.4.3 Conflicts","text":"Letâ€™s take following example: developer \\(D_1\\) developer \\(D_2\\) pulled version v0.1 code time \\(t\\) respective machines. work independently make changes code. pushing /changes, developer \\(D_2\\) receives error message:\"Sync Error.Please resolve conflicted files, commit, try syncing .\"Chaque fichier Ã©tant source de conflit alors Ã©tÃ© automatiquement Ã©ditÃ© comme suit :order solve conflict, manually carefully edit file one one, choosing whether keep local online version code, can commit , finally successfully push changes online.ğŸ‘‰ turn !Edit README.Rmd file paired buddy, commit change, finally push .Edit README.Rmd file paired buddy, commit change, finally push .buddy modified README.Rmd modify file line (make sure discussing together), **WITHOUT* pulling buddyâ€™s changes first! Comment try push changes.buddy modified README.Rmd modify file line (make sure discussing together), **WITHOUT* pulling buddyâ€™s changes first! Comment try push changes.Resolve conflict.Resolve conflict.NB: real life want avoid situation always pull pushing, purposedly opposite sake providing example demystifying conflicts.","code":"<<<<<<< HEAD\nlocal code\n=======\nonline code\n>>>>>>> remote"},{"path":"version-control-with-git-and-github.html","id":"fork","chapter":"2 Version control with git and GitHub","heading":"2.4.4 Fork","text":"fork allows create copy available code repository. Thus original code impacted changes. like creating branch, severing tree, can assume ownership . also called â€œcuttingâ€ continue metaphorâ€¦action mainly useful pull requests (see next).","code":""},{"path":"version-control-with-git-and-github.html","id":"pull-request","chapter":"2 Version control with git and GitHub","heading":"2.4.5 Pull request","text":"Pull requests easiest way propose changes code project contributor . GitHub provides graphical interface makes easy .ğŸ‘‰ turn !Modify README.Rmd neighbor paired-buddy forking package.Modify README.Rmd neighbor paired-buddy forking package.Propose change form pull request GitHub repository webpage (â€œPull requestâ€s tab).Propose change form pull request GitHub repository webpage (â€œPull requestâ€s tab).Accept neighbor pull request repository GitHub website, merge .Accept neighbor pull request repository GitHub website, merge .","code":""},{"path":"version-control-with-git-and-github.html","id":"issues","chapter":"2 Version control with git and GitHub","heading":"2.4.6 Issues","text":"Pour nâ€™importe quel rÃ©pertoire GitHub, vous pouvez poster un commentaire sous forme dâ€™issue afin dâ€™alerter les dÃ©veloppeurs sur un Ã©ventuel bug, ou une question sur lâ€™utilisation du package, ou encore demander une fonctionnalitÃ© supplÃ©mentaireâ€¦Lâ€™idÃ©al est de proposer vous-mÃªme une pull request qui rÃ©sout votre issue lorsque vous le pouvez (.e.Â en avez les capacitÃ©s et le temps).ğŸ‘‰ turn !Utilisez usethis::use_github_links() afin dâ€™ajouter les 2 lignes suivantes au fichier DESCRIPTION de votre packageURL: http://github.com/*prenom.nom*/mypkgBugReports: http://github.com/*prenom.nom*/mypkg/issuesUtilisez usethis::use_github_links() afin dâ€™ajouter les 2 lignes suivantes au fichier DESCRIPTION de votre packageURL: http://github.com/*prenom.nom*/mypkgBugReports: http://github.com/*prenom.nom*/mypkg/issuesVisualisez les nouveau changements, puis commitez les.Visualisez les nouveau changements, puis commitez les.CrÃ©ez une issue sur le projet de votre binomeCrÃ©ez une issue sur le projet de votre binome","code":""},{"path":"version-control-with-git-and-github.html","id":"intÃ©gration-continue","chapter":"2 Version control with git and GitHub","heading":"2.5 IntÃ©gration continue","text":"Ã€ chaque changement, Ã  chaque commit donc, il y la possibilitÃ© dâ€™introduire 1 (ou plusieurs) bugs qui vont empÃªcher le package de passer le CRAN check. Si lâ€™accumule trop de ces bugs, au moment de soumettre la nouvelle version, il peut y avoir beaucoup de corrections Ã  apporter. Câ€™est dâ€™autant plus frustrant si le package passait le CRAN check auparavantâ€¦Les services dâ€™intÃ©gration continue permettent de checker votre package automatiquement aprÃ¨s chaque commit ! En cas dâ€™Ã©chec, vous recevez un mail qui vous en informe. Un certain nombre de ces services proposent une offre limitÃ©e gratuite pour les projets open-source.Une autre raison dâ€™utiliser lâ€™intÃ©gration continue est quâ€™elle permet de tester votre package sur des infrastructures diffÃ©rentes de la votre (e.g.Â Windows, Ubuntu, Mac OS) et pour diffÃ©rentes versions de  (current, develâ€¦)","code":""},{"path":"version-control-with-git-and-github.html","id":"github-actions","chapter":"2 Version control with git and GitHub","heading":"2.5.1 GitHub Actions","text":"Les Github actions permettent de lancer des actions automatiquement Ã  chaque fois que vous pushez sur GitHub La commande usethis::use_github_action_check_standard() permet dâ€™initialiser les Github Actions, et dâ€™ajouter lâ€™action R CMD CHECK du package.vous de jouer !Executez la commande usethis::use_github_action_check_standard() et commitez les changements et regardez ce quâ€™il se passe sur la page GitHubExecutez la commande usethis::use_github_action_check_standard() et commitez les changements et regardez ce quâ€™il se passe sur la page GitHubAjouter un badge Ã  votre README.md grÃ¢ce au code obtenu dans la console R et commitez ces changementsAjouter un badge Ã  votre README.md grÃ¢ce au code obtenu dans la console R et commitez ces changementsNâ€™hÃ©sitez pas Ã  consulter la page suivantes qui renseigne sur les diffÃ©rentes GitHub Actions disponibles pour les pacakges  : https://github.com/r-lib/actions/blob/v1/examples/README.md","code":""},{"path":"version-control-with-git-and-github.html","id":"r-hub","chapter":"2 Version control with git and GitHub","heading":"2.5.2 R-hub","text":"Le R consortium met Ã  disposition le R-hub builder, et pour ambition de bientÃ´t proposer un service dâ€™intÃ©gration continue spÃ©cialement dÃ©diÃ© aux packages .","code":""},{"path":"version-control-with-git-and-github.html","id":"annexe-2.1-couverture-du-code","chapter":"2 Version control with git and GitHub","heading":"2.6 Annexe 2.1 : couverture du code","text":"Le package covr propose une solution pour mesurer la couverture des tests unitaires associÃ©s Ã  un\npackage. La couverture de test dÃ©termine la proportion du code source qui est effectivement utilisÃ©e\nlors de lâ€™exÃ©cution des tests unitaires. La mesure de la couverture du code renforce la fiabilitÃ©\ndâ€™un code et donne confiance Ã  ses utilisateurs potentiels.ğŸ‘‰ turn !Executez la commande usethis::use_coverage(), ajouter un joli badge Ã  votre README.md grÃ¢ce au code obtenu dans la console RCommitez ces changements.Pour plus dâ€™information nâ€™hÃ©sitez pas Ã  consulter la vignette de covr.","code":""},{"path":"mesurer-et-comparer-des-temps-dexÃ©cution.html","id":"mesurer-et-comparer-des-temps-dexÃ©cution","chapter":"3 Mesurer et comparer des temps dâ€™exÃ©cution","heading":"3 Mesurer et comparer des temps dâ€™exÃ©cution","text":"La premiÃ¨re Ã©tape avant dâ€™optimiser un code est de pouvoir mesurer son temps dâ€™exÃ©cution,\nafin de pouvoir comparer les temps dâ€™exÃ©cution entre diffÃ©rente implÃ©mentations.","code":""},{"path":"mesurer-et-comparer-des-temps-dexÃ©cution.html","id":"mesurer-des-temps-dexÃ©cution-avec-system.time","chapter":"3 Mesurer et comparer des temps dâ€™exÃ©cution","heading":"3.1 Mesurer des temps dâ€™exÃ©cution avec system.time()","text":"Pour mesure le temps dâ€™exÃ©cution dâ€™une commande R, peut utiliser la\nfonction system.time() comme ceci :Le problÃ¨me qui apparaÃ®t sur cet exemple est que lâ€™exÃ©cution est tellement\nrapide que system.time() affiche 0 (ou une valeur trÃ¨s proche).\nDe plus, voit quâ€™il y une certaine variabilitÃ© quand relance plusieurs\nfois la commande.Ainsi si souhaite comparer notre code avec la fonction mvtnorm::dmvnorm(),\nne peut pas utiliser system.time() :pourrait se dire quâ€™il faut augmenter la complexitÃ© de notre calcul, mais\nil y mieux : utiliser le package microbenchmark !","code":"\nsystem.time(mvnpdf(x=matrix(rep(1.96, 2), nrow=2, ncol=1), Log=FALSE))## utilisateur     systÃ¨me      Ã©coulÃ© \n##       0.001       0.001       0.004\nsystem.time(mvtnorm::dmvnorm(rep(1.96, 2)))## utilisateur     systÃ¨me      Ã©coulÃ© \n##       0.005       0.003       0.011"},{"path":"mesurer-et-comparer-des-temps-dexÃ©cution.html","id":"comparer-des-temps-dexÃ©cution-avec-microbenchmark","chapter":"3 Mesurer et comparer des temps dâ€™exÃ©cution","heading":"3.2 Comparer des temps dâ€™exÃ©cution avec microbenchmark()","text":"Comme son nom lâ€™indique, ce package permet justement de comparer des temps\ndâ€™exÃ©cution mÃªme quand ceux-ci sont trÃ¨s faibles. De plus, la fonction\nmicrobenchmark() va rÃ©pÃ©ter un certain nombre de fois lâ€™exÃ©cution des\ncommandes et donc va stabiliser le rÃ©sultat.Les deux fonctions mvnpdf() et dmnvorm() Ã©tant capables de prendre en\nentrÃ©e une matrice, peut Ã©galement comparer leurs comportements dans ce\ncas :Il sâ€™est passÃ© un quelque choseâ€¦ Et va diagnostiquer ce problÃ¨me dans la suite.","code":"\nlibrary(microbenchmark)\nmb <- microbenchmark(mvtnorm::dmvnorm(rep(1.96, 2)),\n                     mvnpdf(x=matrix(rep(1.96,2)), Log=FALSE),\n                     times=1000L)\nmb## Unit: microseconds\n##                                           expr    min      lq     mean  median\n##                 mvtnorm::dmvnorm(rep(1.96, 2)) 45.398 51.2140 64.71446 57.3345\n##  mvnpdf(x = matrix(rep(1.96, 2)), Log = FALSE) 41.832 47.9075 63.47425 53.9155\n##       uq      max neval cld\n##  76.7170  229.021  1000   a\n##  70.4265 2810.826  1000   a## Warning: It is deprecated to specify `guide = FALSE` to remove a guide. Please\n## use `guide = \"none\"` instead.\nn <- 100\nmb <- microbenchmark(mvtnorm::dmvnorm(matrix(1.96, nrow = n, ncol = 2)),\n                     mvnpdf(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n                     times=100L)\nmb## Unit: microseconds\n##                                                       expr     min       lq\n##         mvtnorm::dmvnorm(matrix(1.96, nrow = n, ncol = 2))  44.177  51.2470\n##  mvnpdf(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE) 460.699 483.9095\n##       mean   median       uq     max neval cld\n##   66.20254  58.0975  67.9205 268.421   100  a \n##  546.82233 534.4805 581.7460 849.937   100   b## Warning: It is deprecated to specify `guide = FALSE` to remove a guide. Please\n## use `guide = \"none\"` instead."},{"path":"profiler-son-code.html","id":"profiler-son-code","chapter":"4 Profiler son code","heading":"4 Profiler son code","text":"parle de profiling en anglais. Il sâ€™agit de dÃ©terminer ce qui prend\ndu temps dans un code. Le Ã©tant une fois trouvÃ© le bloc de code qui prend\nle plus de temps dans lâ€™exÃ©cution dâ€™optimiser uniquement cette brique.Pour obtenir un profiling du code ci-dessous, sÃ©lectionner les lignes de code\ndâ€™intÃ©rÃªt et aller dans le menu â€œProfileâ€ puis â€œProfile Selected Linesâ€ (ou\nCtrl+Alt+Shift P).OK, get ! ConcatÃ©ner un vecteur au fur et Ã  mesure dans une boucle\nnâ€™est vraiment pas une bonne idÃ©e.","code":"\nn <- 10e4\npdfval <- mvnpdf(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE)"},{"path":"profiler-son-code.html","id":"comparaison-avec-une-version-plus-habile-de-mnvpdf","chapter":"4 Profiler son code","heading":"4.1 Comparaison avec une version plus habile de mnvpdf()","text":"ConsidÃ©rons une nouvelle version de mvnpdf(), appelÃ©e mvnpdfsmart().\nTÃ©lÃ©charger le\nfichier puis\nlâ€™inclure dans le package.Profiler la commande suivante :effectivement rÃ©solu le problÃ¨me et apprend maintenant de maniÃ¨re plus\nfine ce qui prend du temps dans notre fonction.Pour confirmer que mvnpdfsmart() est effectivement bien plus rapide que\nmvnpdf() peut re-faire une comparaison avec microbenchmark() :Et peut Ã©galement voir si devient compÃ©titif avec dmvnorm() :Il y encore du travailâ€¦","code":"\nn <- 10e4\npdfval <- mvnpdfsmart(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE)\nn <- 1000\nmb <- microbenchmark(mvnpdf(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n                     mvnpdfsmart(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n                     times=100L)\nmb## Unit: milliseconds\n##                                                            expr      min\n##       mvnpdf(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE) 4.176674\n##  mvnpdfsmart(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE) 3.209152\n##        lq     mean   median       uq      max neval cld\n##  5.068853 6.310017 5.323596 6.988962 16.61308   100   b\n##  3.735152 4.063631 3.833840 4.046176 16.61640   100  a## Warning: It is deprecated to specify `guide = FALSE` to remove a guide. Please\n## use `guide = \"none\"` instead.\nn <- 1000\nmb <- microbenchmark(mvtnorm::dmvnorm(matrix(1.96, nrow = n, ncol = 2)),\n                     mvnpdf(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n                     mvnpdfsmart(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n                     times=100L)\nmb## Unit: microseconds\n##                                                            expr      min\n##              mvtnorm::dmvnorm(matrix(1.96, nrow = n, ncol = 2))   59.742\n##       mvnpdf(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE) 4179.846\n##  mvnpdfsmart(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE) 3008.074\n##        lq      mean   median       uq       max neval cld\n##    90.848  128.5344  118.886  150.955   461.532   100 a  \n##  5108.045 6261.0634 5259.697 6300.493 15378.970   100   c\n##  3653.584 3924.2745 3789.556 4232.635  6213.149   100  b## Warning: It is deprecated to specify `guide = FALSE` to remove a guide. Please\n## use `guide = \"none\"` instead."},{"path":"profiler-son-code.html","id":"comparaison-avec-une-version-optimisÃ©e-dans-r","chapter":"4 Profiler son code","heading":"4.2 Comparaison avec une version optimisÃ©e dans R","text":"Boris est arrivÃ©e aprÃ¨s plusieurs recherches et tests Ã  une\nversion optimisÃ©e\navec les outils de R.Inclure la fonction mvnpdfoptim() dans le package, puis profiler cette\nfonction :Et un petit microbenchmark() :Pour finir peut profiler la fonction dmvnorm() :","code":"\nn <- 10e4\npdfval <- mvnpdfoptim(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE)\nn <- 1000\nmb <- microbenchmark(mvtnorm::dmvnorm(matrix(1.96, nrow = n, ncol = 2)),\n                     mvnpdf(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n                     mvnpdfsmart(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n                     mvnpdfoptim(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n                     times=100L)\nmb## Unit: microseconds\n##                                                            expr      min\n##              mvtnorm::dmvnorm(matrix(1.96, nrow = n, ncol = 2))   64.534\n##       mvnpdf(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE) 4417.014\n##  mvnpdfsmart(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE) 3180.625\n##  mvnpdfoptim(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE) 2462.845\n##         lq      mean   median       uq       max neval  cld\n##    95.5495  123.8366  114.894  135.465   432.822   100 a   \n##  5075.7400 6338.6837 5284.085 6305.418 15820.175   100    d\n##  3745.4875 4057.6349 3885.347 4234.683  5613.732   100   c \n##  2802.8665 3102.5479 2944.287 3210.158  5002.538   100  b## Warning: It is deprecated to specify `guide = FALSE` to remove a guide. Please\n## use `guide = \"none\"` instead.\nn <- 10e5\npdfval <- mvtnorm::dmvnorm(matrix(1.96, nrow = n, ncol = 2))"},{"path":"rcpp-ou-comment-intÃ©grer-facilement-du-code-cdans-un-package.html","id":"rcpp-ou-comment-intÃ©grer-facilement-du-code-cdans-un-package","chapter":"5 Rcpp ou comment intÃ©grer facilement du code C++dans un package ","heading":"5 Rcpp ou comment intÃ©grer facilement du code C++dans un package ","text":"Rcpp (R-C-Plus-Plus) est un package qui facilite lâ€™interface entre C++ et .  est un langage\ninterprÃ©tÃ©, ce qui facilite un certain nombre de choses (notamment nous donne accÃ¨s Ã  la console\ndans laquelle peut Ã©valuer du code Ã  la volÃ©e). NÃ©anmoins, cette facilitÃ© dâ€™utilisation se\ncompense entre autre par des temps de calcul supÃ©rieurs Ã  ceux de langages de plus bas niveau,\ntels que C, Fortran et C++ (mais qui nÃ©cessitent eux une compilation).dirigera le lecteur curieux vers le livre en ligne\nRcpp everyone de Masaki E. Tsuda, qui\nconstitue une ressource trÃ¨s complÃ¨te pour comprendre lâ€™utilisation de Rcpp en plus de\nlâ€™introduction que lâ€™peut trouver dans le livre Advanced R dâ€™Hadley\nWickham.","code":""},{"path":"rcpp-ou-comment-intÃ©grer-facilement-du-code-cdans-un-package.html","id":"premiÃ¨re-fonction-en-rcpp","chapter":"5 Rcpp ou comment intÃ©grer facilement du code C++dans un package ","heading":"5.1 PremiÃ¨re fonction en Rcpp","text":"ğŸ‘‰ turn !Afin de rendre votre package prÃªt pour lâ€™utilisation avec Rcpp, commencez par executer la commande\nsuivante :Constatez les changements apportÃ©sConstatez les changements apportÃ©sil faut Ã©galement ajouter les 2 commentaires roxygen suivants dans la page dâ€™aide du\npackage dans son ensemble :il faut Ã©galement ajouter les 2 commentaires roxygen suivants dans la page dâ€™aide du\npackage dans son ensemble :Nous allons maintenant crÃ©er une premiÃ¨re fonction en Rcpp permettant dâ€™inverser une matrice.\nPour cela, nous allons nous appuyer sur la library C++ Armadillo.\nIl sâ€™agit dâ€™une library dâ€™algÃ¨bre linÃ©aire moderne et simple, hautement optimisÃ©e, et interfacÃ©e\navec  via le package RcppArmadillo.C++ nâ€™est pas un langage trÃ¨s diffÃ©rent de . Les principales diffÃ©rences qui nous concernent :C++est trÃ¨s efficaces pour le boucles (y compris les boucles emboÃ®tÃ©es). Attention :\nil y souvent un sens qui est plus rapide que lâ€™autre (ceci est dÃ» Ã  la maniÃ¨re dont C++ attribue\net parcours la mÃ©moire).C++est trÃ¨s efficaces pour le boucles (y compris les boucles emboÃ®tÃ©es). Attention :\nil y souvent un sens qui est plus rapide que lâ€™autre (ceci est dÃ» Ã  la maniÃ¨re dont C++ attribue\net parcours la mÃ©moire).Chaque commande doit se terminer par un point virgule â€˜;â€™Chaque commande doit se terminer par un point virgule â€˜;â€™C++est un langage typÃ© : il faut dÃ©clarer le type de chaque variable avant de pouvoir\nlâ€™utiliser.C++est un langage typÃ© : il faut dÃ©clarer le type de chaque variable avant de pouvoir\nlâ€™utiliser.ğŸ‘‰ turn !CrÃ©ez un nouveau fichier C++ depuis RStudio (via le menu File > New File > C++ File),\net enregistrez le dans le dossier src. Prenez le temps de le lire et essayez de comprendre\nchaque ligne.CrÃ©ez un nouveau fichier C++ depuis RStudio (via le menu File > New File > C++ File),\net enregistrez le dans le dossier src. Prenez le temps de le lire et essayez de comprendre\nchaque ligne.Compilez et chargez votre package (via le bouton â€œInstall Restartâ€) et essayez dâ€™utiliser\nla fonction timesTwo() depuis la console.Compilez et chargez votre package (via le bouton â€œInstall Restartâ€) et essayez dâ€™utiliser\nla fonction timesTwo() depuis la console.Installez le package RcppArmadillo, et nâ€™oubliez pas de faire les ajouts nÃ©cessaires dans\nDESCRIPTION (cf.Â Rcpp prÃ©cÃ©dement - vous pouvez expÃ©rimentez avec la fonction\nRcppArmadillo::RcppArmadillo.package.skeleton() qui le dÃ©savantage de crÃ©er beaucoup de fichiers\ninutiles)Installez le package RcppArmadillo, et nâ€™oubliez pas de faire les ajouts nÃ©cessaires dans\nDESCRIPTION (cf.Â Rcpp prÃ©cÃ©dement - vous pouvez expÃ©rimentez avec la fonction\nRcppArmadillo::RcppArmadillo.package.skeleton() qui le dÃ©savantage de crÃ©er beaucoup de fichiers\ninutiles)Ã€ lâ€™aide de la documentation des packages Rcpp\net RcppArmadillo de celle de la\nlibrary Armadillo, tentez dâ€™Ã©crire une courte fonction\ninvC en C++ calculant lâ€™inverse dâ€™une matrice.Ã€ lâ€™aide de la documentation des packages Rcpp\net RcppArmadillo de celle de la\nlibrary Armadillo, tentez dâ€™Ã©crire une courte fonction\ninvC en C++ calculant lâ€™inverse dâ€™une matrice.Lorsque vous avez rÃ©ussi Ã  compiler votre fonction invC et quâ€™elle est accÃ¨ssible depuis \ncrÃ©er une fonction mvnpdf_invC() Ã  partir de lâ€™implÃ©mentation de mvnpdfsmart en remplaÃ§ant\nuniquement les calculs dâ€™inverse matriciel par un appel Ã  invC.Lorsque vous avez rÃ©ussi Ã  compiler votre fonction invC et quâ€™elle est accÃ¨ssible depuis \ncrÃ©er une fonction mvnpdf_invC() Ã  partir de lâ€™implÃ©mentation de mvnpdfsmart en remplaÃ§ant\nuniquement les calculs dâ€™inverse matriciel par un appel Ã  invC.Evaluer le gain en performance de cette nouvelle implÃ©mentation mvnpdf_invCEvaluer le gain en performance de cette nouvelle implÃ©mentation mvnpdf_invC","code":"\ndevtools::use_rcpp()\n#' @useDynLib mypkgr\n#' @importFrom Rcpp sourceCpp, .registration = TRUE\nNULL\nn <- 1000\nmb <- microbenchmark(mvtnorm::dmvnorm(matrix(1.96, nrow = n, ncol = 2)),\n                     mvnpdf(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n                     mvnpdfsmart(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n                     mvnpdfoptim(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n                     mvnpdf_invC(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n                     times=100L)\nmb## Unit: microseconds\n##                                                            expr      min\n##              mvtnorm::dmvnorm(matrix(1.96, nrow = n, ncol = 2))   65.495\n##       mvnpdf(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE) 4308.619\n##  mvnpdfsmart(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE) 3274.853\n##  mvnpdfoptim(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE) 2479.931\n##  mvnpdf_invC(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE) 3095.663\n##        lq      mean   median       uq       max neval  cld\n##    91.236  116.2199  118.449  132.081   218.632   100 a   \n##  5036.363 5718.8885 5239.233 5615.760 14230.121   100    d\n##  3766.895 3917.2765 3848.121 3994.213  5259.445   100   c \n##  2856.784 3099.5732 2964.369 3163.305  9240.294   100  b  \n##  3717.025 4056.2482 3851.596 4014.794 12374.808   100   c## Warning: It is deprecated to specify `guide = FALSE` to remove a guide. Please\n## use `guide = \"none\"` instead.\nprofvis::profvis(mvnpdfoptim(x=matrix(1.96, \n    nrow = 2, ncol = 1000), Log=FALSE))\nprofvis::profvis(mvnpdfoptim(x=matrix(1.96, \n    nrow = 100, ncol = 1000), Log=FALSE))"},{"path":"rcpp-ou-comment-intÃ©grer-facilement-du-code-cdans-un-package.html","id":"optimisation-grÃ¢ce-Ã -c","chapter":"5 Rcpp ou comment intÃ©grer facilement du code C++dans un package ","heading":"5.2 Optimisation grÃ¢ce Ã  C++","text":"En rÃ¨gle gÃ©nÃ©rale, ne gagne pas beaucoup en temps de calcul en remplaÃ§ant une fonction \noptimisÃ©e par une fonction en C++. En effet, la plupart des fonctions de base de  sâ€™appuie en\nrÃ©alitÃ© dÃ©jÃ  sur des routines C ou Fortran bien optimisÃ©e. Le gain se limite alors simplement\nÃ  la suppression des vÃ©rifications des arguments et de la gestion des diffÃ©rents types.ğŸ‘‰ turn !Ã€ partir de mvnpdfsmart, proposez une implÃ©mentation completement en C++ du calcul\nde densitÃ© de la loi Normale multivariÃ©e mvnpdfC().Ã€ partir de mvnpdfsmart, proposez une implÃ©mentation completement en C++ du calcul\nde densitÃ© de la loi Normale multivariÃ©e mvnpdfC().Evaluer le gain en performance de cette nouvelle implÃ©mentation mvnpdf_invCEvaluer le gain en performance de cette nouvelle implÃ©mentation mvnpdf_invCVous pouvez tÃ©lÃ©charger notre proposition de mvnpdfC.cpp ici.Ã€ noter que vous pouvez utiliser des fonctions Rcpp en dehors de lâ€™architecture\ndâ€™un package grÃ¢ce Ã  la fonction Rcpp::sourceCpp(). Mais comme nous avons\nquâ€™il est prÃ©fÃ©rable de gÃ©rer tous ces code sous la forme de package, il est\npeu probable que vous en ayez besoin !","code":"\nn <- 1000\nmb <- microbenchmark(mvtnorm::dmvnorm(matrix(1.96, nrow = n, ncol = 2)),\n                     mvnpdf(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n                     mvnpdfsmart(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n                     mvnpdfoptim(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n                     mvnpdf_invC(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n                     mvnpdfC(x=matrix(1.96, nrow = 2, ncol = n), mean = rep(0, 2), varcovM = diag(2), Log=FALSE),\n                     times=100L)\nmb## Unit: microseconds\n##                                                                                                  expr\n##                                                    mvtnorm::dmvnorm(matrix(1.96, nrow = n, ncol = 2))\n##                                             mvnpdf(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE)\n##                                        mvnpdfsmart(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE)\n##                                        mvnpdfoptim(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE)\n##                                        mvnpdf_invC(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE)\n##  mvnpdfC(x = matrix(1.96, nrow = 2, ncol = n), mean = rep(0, 2),      varcovM = diag(2), Log = FALSE)\n##       min        lq       mean    median        uq       max neval  cld\n##    66.434   83.4995  124.87542  117.7775  140.6925   339.456   100 a   \n##  4130.253 5052.0940 5920.27972 5320.7840 6026.3910 16604.560   100    d\n##  3067.362 3714.9875 4109.58383 3863.7535 4190.1640  8684.367   100   c \n##  2321.332 2806.3075 3401.44994 2988.2830 3205.6120 12693.115   100  b  \n##  3141.884 3726.0465 4340.75585 3868.9200 4144.7310 11892.813   100   c \n##    46.559   60.0250   96.81958   69.5445   78.5320  2433.048   100 a## Warning: It is deprecated to specify `guide = FALSE` to remove a guide. Please\n## use `guide = \"none\"` instead."},{"path":"rcpp-ou-comment-intÃ©grer-facilement-du-code-cdans-un-package.html","id":"annexe-5.1-loptimisation-prÃ©maturÃ©e-nest-pas-une-bonne-idÃ©e","chapter":"5 Rcpp ou comment intÃ©grer facilement du code C++dans un package ","heading":"5.3 Annexe 5.1 : lâ€™optimisation prÃ©maturÃ©e nâ€™est pas une bonne idÃ©e","text":"Chambers, Software Data Analysis: Programming R, Springer, 2008 :Including additional C code serious step, added dangers\noften substantial amount programming debugging required.\ngood reason.","code":""},{"path":"parallÃ©lisation-du-code.html","id":"parallÃ©lisation-du-code","chapter":"6 ParallÃ©lisation du code ","heading":"6 ParallÃ©lisation du code ","text":"","code":""},{"path":"parallÃ©lisation-du-code.html","id":"introduction-Ã -lexecution-parallÃ¨le-sous","chapter":"6 ParallÃ©lisation du code ","heading":"6.1 Introduction Ã  lâ€™execution parallÃ¨le sous ","text":"En dehors de lâ€™optimisation du code et des algorithmes, une autre faÃ§on\ndâ€™obtenir un code performant est de tirer profit des architectures parallÃ¨les\ndes ordinateurs modernes. Il sâ€™agit alors de parallÃ©liser son code afin de\nfaire des opÃ©rations simultanÃ©es sur des parties distinctes dâ€™un mÃªme problÃ¨me,\nen utilisant diffÃ©rent cÅ“urs de calcul. ne rÃ©duit pas le temps de calcul\ntotal nÃ©cessaire, mais lâ€™ensemble des opÃ©rations sâ€™exÃ©cute plus rapidement.Il existe un nombre non nÃ©gligeable dâ€™algorithmes qui sont dâ€™un â€œparallÃ©lisme\nembarrassantâ€, câ€™est-Ã -dire dont les calculs peuvent se dÃ©composer en plusieurs\nsous-calculs indÃ©pendants. En statistique, il est ainsi souvent facile et direct\nde parallÃ©liser selon les diffÃ©rentes observations ou selon les diffÃ©rentes\ndimensions. Typiquement, il sâ€™agit dâ€™opÃ©rations que lâ€™peut Ã©crire sous la\nforme de boucle dont les opÃ©rations sont indÃ©pendantes dâ€™une itÃ©ration de la\nboucle Ã  lâ€™autre.Les opÃ©rations nÃ©cessaires pour lâ€™Ã©tablissement dâ€™un code parallÃ¨le sont les suivantes :DÃ©marrer \\(m\\) processus â€œtravailleursâ€ (.e.Â cÅ“urs de calcul) et les initialiserDÃ©marrer \\(m\\) processus â€œtravailleursâ€ (.e.Â cÅ“urs de calcul) et les initialiserEnvoyer les fonctions et donnÃ©es nÃ©cessaires pour chaque tache aux travailleursEnvoyer les fonctions et donnÃ©es nÃ©cessaires pour chaque tache aux travailleursSÃ©parer les taches en \\(m\\) opÃ©rations dâ€™envergure similaire et les envoyer aux travailleursSÃ©parer les taches en \\(m\\) opÃ©rations dâ€™envergure similaire et les envoyer aux travailleursAttendre que tous les travailleurs aient terminer leurs calculs et obtenir leurs rÃ©sultatsAttendre que tous les travailleurs aient terminer leurs calculs et obtenir leurs rÃ©sultatsRassembler les rÃ©sultats des diffÃ©rents travailleursRassembler les rÃ©sultats des diffÃ©rents travailleursArrÃªter les processus travailleursArrÃªter les processus travailleursSelon les plateformes, plusieurs protocoles de communications sont disponibles\nentre les cÅ“urs. Sous les systÃ¨mes UNIX, le protocole Fork est le plus\nutilisÃ©, mais il nâ€™est pas disponible sous Windows oÃ¹ utilise\nprÃ©fÃ©rentiellement le protocole PSOCK. Enfin, pour les architecture de calcul\ndistribuÃ©e oÃ¹ les cÅ“urs ne se trouvent pas nÃ©cessairement sur le mÃªme processeur\nphysique, utilise gÃ©nÃ©ralement le protocole MPI. Lâ€™avantage des packages\nfuture et future.apply est que le mÃªme code pourra Ãªtre exÃ©cutÃ© quelque soit\nla configuration matÃ©rielle.Il existe un nombre important de packages et dâ€™initiatives permettant de faire\ndu calcul en R. Depuis R 2.14.0, le package\nparallel\nest inclus directement dans  et permet de dÃ©marrer et dâ€™arrÃªter un â€œclusterâ€\nde plusieurs processus travailleur (Ã©tape 1 et 6). En plus du package\nparallel, va donc utiliser le package future qui permet de gÃ©rer les\nprocessus travailleurs et la communication et lâ€™articulation avec le package\nfuture.applyqui permet lui de gÃ©rer le dialogue avec les travailleurs (envois,\nrÃ©ception et rassemblement des rÃ©sultats - Ã©tapes 2, 3, 4 et 5).","code":""},{"path":"parallÃ©lisation-du-code.html","id":"premiÃ¨re-fonction-parallÃ¨le-en","chapter":"6 ParallÃ©lisation du code ","heading":"6.2 PremiÃ¨re fonction parallÃ¨le en ","text":"Ã€ vous de jouer !Commencez par Ã©crire une fonction simple qui calcule le logarithme de \\(n\\)\nnombres:DÃ©terminez combien de coeurs sont disponibles sur votre marchine grÃ¢ce Ã \nla fonction future::availableCores().DÃ©terminez combien de coeurs sont disponibles sur votre marchine grÃ¢ce Ã \nla fonction future::availableCores().Ã€ lâ€™aide de la fonction future::plan(multisession(workers = XX)),\ndÃ©clarez un â€œplanâ€ de calculs parallÃ¨les sur votre ordinateur (en prenant garde\nÃ  laisser un coeur disponible pour traiter les autres processus).Ã€ lâ€™aide de la fonction future::plan(multisession(workers = XX)),\ndÃ©clarez un â€œplanâ€ de calculs parallÃ¨les sur votre ordinateur (en prenant garde\nÃ  laisser un coeur disponible pour traiter les autres processus).Ã€ lâ€™aide dâ€™une fonction de type apply future.apply::future_*apply(),\ncalculez le log des \\(n\\) nombres en parallÃ¨le et concatÃ©nez les rÃ©sultats dans un\nvecteur.Ã€ lâ€™aide dâ€™une fonction de type apply future.apply::future_*apply(),\ncalculez le log des \\(n\\) nombres en parallÃ¨le et concatÃ©nez les rÃ©sultats dans un\nvecteur.Comparez le temps dâ€™Ã©xecution avec celui dâ€™une fonction sÃ©quentielle\nsur les 100 premiers entiers, grÃ¢ce Ã  la commande :microbenchmark(log_par(1:100), log_seq(1:100), times=10)Comparez le temps dâ€™Ã©xecution avec celui dâ€™une fonction sÃ©quentielle\nsur les 100 premiers entiers, grÃ¢ce Ã  la commande :microbenchmark(log_par(1:100), log_seq(1:100), times=10)La version parallÃ¨le tourne beaucoup plus lentementâ€¦ Car en fait, si les\ntÃ¢ches individuelles sont trop rapides,  va passer plus de temps Ã \ncommuniquer avec les cÅ“urs, quâ€™Ã  faire les calculs effectifs.Il faut quâ€™une itÃ©ration de la boucle soit relativement longue pour que le\ncalcul parallÃ¨le apporte un gain en temps de calcul !En augmentant \\(n\\), observe une rÃ©duction de la diffÃ©rence entre les 2\nimplÃ©mentations (le temps de calcul en parallÃ¨le augmente trÃ¨s lentement comparÃ©\nÃ  lâ€™augmentation de celui de la fonction sÃ©quentielle).NB : les itÃ©rateurs dâ€™itertools sont trÃ¨s performants mais ne peuvent\nservir que lorsque le code Ã  lâ€™intÃ©rieur de future_*apply() est vectorisÃ© (il\nest toujours possible de vectoriser le code Ã  lâ€™intÃ©rieur, par exemple avec une\nfonction de type apply). Ils minimisent le nombre de communication entre les\ncoeurs.","code":"\nlibrary(microbenchmark)\nlibrary(future.apply)\n\nlog_seq <- function(x){\n  # try this yourself (spoiler alert: it is quite long...):\n  # res <- numeric(length(x))\n  # for(i in 1:length(x)){\n  #   res[i] <- log(x[i])\n  # }\n  # return(res)\n  return(log(x))\n}\n\nlog_par <- function(x){\n  res <- future_sapply(1:length(x), FUN = function(i) {\n    log(x[i])\n  })\n  return(res)\n}\n\nplan(multisession(workers = 3))\nmb <- microbenchmark(log_par(1:100), log_seq(1:100), times = 50)"},{"path":"parallÃ©lisation-du-code.html","id":"parallÃ©lisation-efficace","chapter":"6 ParallÃ©lisation du code ","heading":"6.3 ParallÃ©lisation efficace","text":"va maintenant se pencher sur un autre cas dâ€™utilisation. Imaginons que lâ€™\nait un grand tableau de donnÃ©es de taille comportant 10 observations pour 100\n000 variables (e.g.Â des mesures de gÃ©nomique), et que lâ€™veuille calculer la\nmÃ©diane pour chacune de ces variables.Pour un utilisateur averti de , une telle opÃ©ration se programme facilement\nÃ  lâ€™aide de la fonction apply :En rÃ©alitÃ©, une boucle nâ€™est pas plus lente Ã  condition dâ€™Ãªtre bien\nprogrammÃ©e :Ã€ vous de jouer !\nEssayez dâ€™amÃ©liorer encore ce temps de calcul en parallÃ©lisant :ParallÃ©lisez le calcul de la mÃ©diane de chacune des 100 000 variables.\nObserve-t-un gain en temps de calcul ?ParallÃ©lisez le calcul de la mÃ©diane de chacune des 100 000 variables.\nObserve-t-un gain en temps de calcul ?Proposez une implÃ©mentation alternative grÃ¢ce Ã  la fonction\nitertools::isplitIndices() qui permet de sÃ©parer vos donnÃ©es (les \\(n\\) nombres)\nen autant de groupes que vous avez de coeurs. Comparez Ã  nouveau les temps de\ncalcul.Proposez une implÃ©mentation alternative grÃ¢ce Ã  la fonction\nitertools::isplitIndices() qui permet de sÃ©parer vos donnÃ©es (les \\(n\\) nombres)\nen autant de groupes que vous avez de coeurs. Comparez Ã  nouveau les temps de\ncalcul.","code":"\nx <- matrix(rnorm(1e6), nrow = 10)\ndim(x)## [1]     10 100000\ncolmedian_apply <- function(x){\n  return(apply(x, 2, median))\n}\nsystem.time(colmedian_apply(x))## utilisateur     systÃ¨me      Ã©coulÃ© \n##       2.883       0.013       2.959\ncolmedian_for <- function(x){\n  ans <- rep(0, ncol(x)) \n  for (i in 1:ncol(x)) {\n    ans[i] <- median(x[, i]) \n  }\n  return(ans)\n}\nsystem.time(colmedian_for(x))## utilisateur     systÃ¨me      Ã©coulÃ© \n##       2.554       0.007       2.565\ncolmedian_par <- function(x){\n  res <- future_sapply(1:ncol(x), FUN = function(i) {\n          median(x[, i])\n    })\n  return(res)\n}\nplan(multisession(workers = 3))\nsystem.time(colmedian_par(x))## utilisateur     systÃ¨me      Ã©coulÃ© \n##       0.101       0.019       1.439\ncolmedian_parIter <- function(x, ncores = 1){\n  iter <- itertools::isplitIndices(n = ncol(x), chunks = ncores)\n  res <- future_sapply(iter, FUN = function(i) {\n          apply(x[, i], 2, median)\n    })\n  return(unlist(res))\n}\nsystem.time(colmedian_parIter(x, ncores = 3))## utilisateur     systÃ¨me      Ã©coulÃ© \n##       0.082       0.017       1.245\nmb <- microbenchmark(colmedian_apply(x), \n                     colmedian_for(x),\n                     colmedian_par(x),\n                     colmedian_parIter(x, ncores = 3), times = 10)\nmb## Unit: milliseconds\n##                              expr       min       lq     mean   median       uq\n##                colmedian_apply(x) 2508.9098 2629.735 2689.872 2691.283 2783.711\n##                  colmedian_for(x) 2549.3103 2574.686 2758.920 2674.481 2740.282\n##                  colmedian_par(x) 1092.2788 1123.261 1154.978 1133.733 1143.486\n##  colmedian_parIter(x, ncores = 3)  993.0038 1045.915 1129.355 1081.597 1111.276\n##       max neval cld\n##  2796.538    10   b\n##  3612.499    10   b\n##  1362.110    10  a \n##  1636.029    10  a"},{"path":"parallÃ©lisation-du-code.html","id":"les-itÃ©rateurs","chapter":"6 ParallÃ©lisation du code ","heading":"6.3.1 Les itÃ©rateurs","text":"Le package itertools permet de sÃ©parer facilement des donnÃ©es ou des\ntaches (Ã©tape 3) tout en minimisant les communications avec les diffÃ©rents\ntravailleurs. Il sâ€™appuie sur une implÃ©mentation des itÃ©rateurs en .\nSon utilisation nÃ©cessite nÃ©anmoins de vectoriser le code Ã  lâ€™intÃ©rieur de\nfuture_*apply(). ExpÃ©rimentez avec le petit code ci-dessous :","code":"\nmyiter <- itertools::isplitIndices(n = 30, chunks = 3)\n\n# Une premiÃ¨re fois\niterators::nextElem(myiter)##  [1]  1  2  3  4  5  6  7  8  9 10\n# Une deuxiÃ¨me fois... Oh ?!\niterators::nextElem(myiter)##  [1] 11 12 13 14 15 16 17 18 19 20\n# Encore !\niterators::nextElem(myiter)##  [1] 21 22 23 24 25 26 27 28 29 30\n# Encore ?\niterators::nextElem(myiter)## Error: StopIteration"},{"path":"parallÃ©lisation-du-code.html","id":"les-autres-plans-de-calculs-parallÃ¨le","chapter":"6 ParallÃ©lisation du code ","heading":"6.3.2 Les autres â€œplansâ€ de calculs parallÃ¨le","text":"Pour exÃ©cuter votre code (exactement le mÃªme code, câ€™est un des avantages\ndu packages de la famille future*), vous devez rÃ©gler un â€œplanâ€ de calculs :sur un ordinateur (ou un unique serveur de calcul) sous Unix (Linux, Mac OS),\nvous pouvez utiliser plan(multicore(workers = XX)) qui est souvent plus\nperformant. Le plan multisession fonctionne toujours.sur un ordinateur (ou un unique serveur de calcul) sous Unix (Linux, Mac OS),\nvous pouvez utiliser plan(multicore(workers = XX)) qui est souvent plus\nperformant. Le plan multisession fonctionne toujours.sur un cluster de calculs (type Avakas Ã  Bordeaux), nous renvoyons au package\nfuture.batchtoolssur un cluster de calculs (type Avakas Ã  Bordeaux), nous renvoyons au package\nfuture.batchtools","code":""},{"path":"parallÃ©lisation-du-code.html","id":"parallÃ©lisation-dans-notre-exemple-fil-rouge","chapter":"6 ParallÃ©lisation du code ","heading":"6.4 ParallÃ©lisation dans notre exemple fil rouge","text":"Ã€ vous de jouer !Ã€ partir de la fonction mvnpdfoptim() et/ou mvnpdfsmart(), proposez\nune implÃ©mentation parallÃ©lisant les calculs sur les observations (colonnes de \\(x\\))Ã€ partir de la fonction mvnpdfoptim() et/ou mvnpdfsmart(), proposez\nune implÃ©mentation parallÃ©lisant les calculs sur les observations (colonnes de \\(x\\))Comparez les temps de calcul sur 10 000 observationsComparez les temps de calcul sur 10 000 observations","code":"\nplan(multisession(workers = 3))\nn <- 10000\nmb <- microbenchmark::microbenchmark(\n  mvtnorm::dmvnorm(matrix(1.96, nrow = n, ncol = 2)),\n  mypkgr::mvnpdfoptim(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n  mypkgr::mvnpdfoptim_par(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE),\n  mypkgr::mvnpdfoptim_parIter(x=matrix(1.96, nrow = 2, ncol = n), Log=FALSE, ncores = 3),\n  times=20L)\nmb## Unit: microseconds\n##                                                                                             expr\n##                                               mvtnorm::dmvnorm(matrix(1.96, nrow = n, ncol = 2))\n##                           mypkgr::mvnpdfoptim(x = matrix(1.96, nrow = 2, ncol = n), Log = FALSE)\n##                  mypkgr::mvnpdfoptim_par(x = matrix(1.96, nrow = 2, ncol = n),      Log = FALSE)\n##  mypkgr::mvnpdfoptim_parIter(x = matrix(1.96, nrow = 2, ncol = n),      Log = FALSE, ncores = 3)\n##        min         lq       mean     median         uq       max neval cld\n##    300.519   344.0155   362.6347   352.9305   392.7385    447.60    20  a \n##  24144.586 27844.8270 29340.4425 28354.5550 29700.8440  37591.64    20  ab\n##  21117.246 24406.5590 25520.3099 25217.5930 26919.3365  28695.41    20  ab\n##  20026.677 22529.1105 40802.1316 25208.0950 26377.1595 349567.61    20   b"},{"path":"parallÃ©lisation-du-code.html","id":"conclusion","chapter":"6 ParallÃ©lisation du code ","heading":"6.5 Conclusion","text":"La parallÃ©lisation permet de gagner du temps, mais il faut dâ€™abord bien\noptimiser son code. Quand parallÃ©lise un code, le gain sur la durÃ©e\ndâ€™exÃ©cution dÃ©pend avant tout du ratio entre le temps de communication et le\ntemps de calcul effectif pour chaque tache.","code":""},{"path":"miscÃ©lanÃ©es.html","id":"miscÃ©lanÃ©es","chapter":"7 MiscÃ©lanÃ©es","heading":"7 MiscÃ©lanÃ©es","text":"","code":""},{"path":"miscÃ©lanÃ©es.html","id":"debugging-avec-browser","chapter":"7 MiscÃ©lanÃ©es","heading":"7.1 Debugging avec browser()","text":"","code":""},{"path":"miscÃ©lanÃ©es.html","id":"attach","chapter":"7 MiscÃ©lanÃ©es","heading":"7.2 attach","text":"","code":""},{"path":"miscÃ©lanÃ©es.html","id":"gestion-mÃ©moire","chapter":"7 MiscÃ©lanÃ©es","heading":"7.3 gestion mÃ©moire","text":"","code":""},{"path":"miscÃ©lanÃ©es.html","id":"copies-et-variables-localesglobales-dans-les-fonctions","chapter":"7 MiscÃ©lanÃ©es","heading":"7.4 copies et variables locales/globales dans les fonctions","text":"","code":""},{"path":"miscÃ©lanÃ©es.html","id":"naming","chapter":"7 MiscÃ©lanÃ©es","heading":"7.5 naming","text":"","code":""},{"path":"miscÃ©lanÃ©es.html","id":"gpplot2","chapter":"7 MiscÃ©lanÃ©es","heading":"7.6 gpplot2","text":"","code":""},{"path":"take-home-message.html","id":"take-home-message","chapter":"8 Take Home message","heading":"8 Take Home message","text":"MAKE PACKAGESMAKE PACKAGESuse git, least locally yourselfuse git, least locally yourselfif needed (.e.Â optimization  code ), afraid using Rcpp /parallelizing tour codeif needed (.e.Â optimization  code ), afraid using Rcpp /parallelizing tour code","code":""},{"path":"further-reading.html","id":"further-reading","chapter":"Further reading","heading":"Further reading","text":"Hadley Wickhamâ€™s online books truly excellent contain lot supplementary informattion covered training:\nwebsite writing packages R packages.\nwebsite Advanced R everything regarding optimization, Rcpp, parallel computing.\nwebsite R Data Science also quite comprehensive includes chapters data management , also structures , modeling, well elements graphics Rmarkdown.\nHadley Wickhamâ€™s online books truly excellent contain lot supplementary informattion covered training:website writing packages R packages.website writing packages R packages.website Advanced R everything regarding optimization, Rcpp, parallel computing.website Advanced R everything regarding optimization, Rcpp, parallel computing.website R Data Science also quite comprehensive includes chapters data management , also structures , modeling, well elements graphics Rmarkdown.website R Data Science also quite comprehensive includes chapters data management , also structures , modeling, well elements graphics Rmarkdown.online book Rcpp everyone Masaki E. Tsuda also good.online book Rcpp everyone Masaki E. Tsuda also good.","code":""}]
